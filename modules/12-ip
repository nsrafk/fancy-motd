#!/usr/bin/env bash

#set -euo pipefail
# shellcheck source=./framework.sh
source "${BASE_DIR}/framework.sh"

#ips_v4=$(ip a | awk '/inet / && /global/ {split($2, arr, /\//); print arr[1]}')
#IFS=$'\n' read -r -d '' -a ips <<< "${ips_v4}"

#text=$(print_wrap "${WIDTH}" "${ips[@]}")

#print_columns "IP addresses" "${text}"

# Extract IPv4 addresses and store them in a variable
ips_v4=$(ip a | awk '/inet / && /global/ {split($2, arr, /\//); print arr[1]}')
echo "DEBUG: ips_v4='$ips_v4'"  # Debugging statement

# Initialize an empty array
ips=()

# Read each line from ips_v4 into the array
while IFS= read -r line; do
    ips+=("$line")
done <<< "$ips_v4"

# Check the number of IPs and print each one for debugging
echo "DEBUG: Number of IPs found: ${#ips[@]}"  # Debugging statement
for ip in "${ips[@]}"; do
    echo "DEBUG: IP='$ip'"  # Debugging statement
done

# Wrap the IP addresses
text=$(print_wrap "${WIDTH}" "${ips[@]}")
echo "DEBUG: Wrapped text='$text'"  # Debugging statement

# Print the IP addresses in columns
print_columns "IP addresses" "${text}"
